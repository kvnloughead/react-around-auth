(this["webpackJsonparound-app"]=this["webpackJsonparound-app"]||[]).push([[0],{11:function(e,t){var a="https://register.nomoreparties.co";e.exports.register=function(e,t){return fetch("".concat(a,"/signup"),{method:"POST",headers:{Acccept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()}))},e.exports.authorize=function(e,t){return fetch("".concat(a,"/signin"),{method:"POST",headers:{Acccept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){if(!e.message)return localStorage.setItem("token",e.token),e}))},e.exports.getContent=function(e){return fetch("".concat(a,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.ok?e.json():Promise.reject("".concat(e.status," - ").concat(e.message))})).then((function(e){return e})).catch((function(e){return console.log(e)}))}},18:function(e,t,a){},21:function(e,t,a){e.exports=a.p+"static/media/header-logo.71ad3aff.svg"},24:function(e,t,a){e.exports=a.p+"static/media/checkmark.75df9ada.svg"},25:function(e,t,a){e.exports=a.p+"static/media/redX.db56ee32.svg"},28:function(e,t,a){e.exports=a(39)},33:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(19),i=a.n(r),c=a(4),l=(a(33),a(26)),s=a(2),u=a(1);var m=function(e){var t=e.loggedIn,a=e.userEmail,n=e.handleSignOut;return o.a.createElement(o.a.Fragment,null,t&&o.a.createElement("ul",{className:"header__links"},o.a.createElement("li",{className:"header__email"},a),o.a.createElement("li",null,o.a.createElement(c.b,{className:"header__link",onClick:n,to:"/signin"},"Log out"))))},p=a(21),d=a.n(p);var h=function(e){var t=e.userEmail,a=e.loggedIn,n=e.handleSignOut;return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"header__logo",src:d.a,alt:"Around the U.S. Logo"}),o.a.createElement(m,{loggedIn:a,userEmail:t,handleSignOut:n}))},f=a(27),g=function(e){var t=e.component,a=Object(f.a)(e,["component"]);return o.a.createElement(u.b,null,(function(){return a.loggedIn?o.a.createElement(t,a):o.a.createElement(u.a,{to:"/signin"})}))},_=o.a.createContext();var b=function(e){var t=o.a.useContext(_),a=t&&e.card.owner===t._id,n="place__delete-btn ".concat(!a&&"place__delete-btn_hidden"),r=t&&e.card.likes.includes(t._id),i="place__like-btn ".concat(r&&"place__like-btn_clicked");return o.a.createElement("li",{key:e.card._id,className:"place"},o.a.createElement("div",{className:"place__image",style:{backgroundImage:"url(".concat(e.card.link,")")},onClick:function(){e.onCardClick(e.card)}}),o.a.createElement("button",{className:n,"aria-label":"delete-card",onClick:function(){e.onCardDelete(e.card)}}),o.a.createElement("div",{className:"place__footer"},o.a.createElement("h2",{className:"place__name"},e.card.name),o.a.createElement("div",{className:"place__like-container"},o.a.createElement("button",{className:"".concat(i).concat(r?" place__like-btn_clicked":""),"aria-label":"like-or-unlike-card",onClick:function(){e.onCardLike(e.card)}}),o.a.createElement("p",{className:"place__like-counter"},e.card.likes.length))))};var E=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"popup__overlay"+(e.isOpen&&!e.name.startsWith("sign")?" popup__overlay_visible":"")}),o.a.createElement("div",{className:"popup__container popup__container_type_".concat(e.name)+(e.isOpen?" popup__container_visible":"")+(e.name.startsWith("sign")?" splash-page":"")},o.a.createElement("button",{className:"button button_action_close"+(e.name.startsWith("sign")?" button_hidden":""),type:"reset","aria-label":"close-".concat(e.name,"-modal"),onClick:e.onClose}),o.a.createElement("h2",{className:e.name.startsWith("sign")?"splash-page__title":"popup__title"},e.title),o.a.createElement("form",{id:"".concat(e.name,"-form"),name:"".concat(e.name,"Form"),className:"popup__form",action:"#",noValidate:!0,onSubmit:e.onSubmit},e.children)))};var v=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"popup__overlay"+(e.card?" popup__overlay_visible":"")}),o.a.createElement("figure",{className:"popup__image-container popup__container_type_image"+(e.card?" popup__image-container_visible":"")},o.a.createElement("button",{className:"button button_action_close",type:"reset","aria-label":"close-image-popup",onClick:e.onClose}),o.a.createElement("img",{src:e.card?e.card.link:"",alt:e.card?e.card.title:"",className:"popup__image"}),o.a.createElement("figcaption",{className:"popup__image-caption"},e.card?e.card.title:"")))};var C=function(e){var t=o.a.useContext(_);return o.a.createElement("main",null,o.a.createElement("section",{className:"profile"},o.a.createElement("div",null,o.a.createElement("img",{src:t&&t.avatar,alt:"Avatar",className:"profile__image",onClick:e.onEditAvatar}),o.a.createElement("button",{className:"button button_action_change-avatar","aria-label":"open-change-avatar-modal"})),o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",{className:"profile__text"},o.a.createElement("h2",{className:"profile__name"},t&&t.name),o.a.createElement("p",{className:"profile__job"},t&&t.about)),o.a.createElement("button",{className:"button button_action_edit","aria-label":"open-edit-profile-modal",onClick:e.onEditProfile})),o.a.createElement("button",{className:"button button_action_add","aria-label":"open-new-card-modal",onClick:e.onAddPlace})),o.a.createElement("div",{className:"places"},o.a.createElement("ul",{className:"places__grid"},e.cards.map((function(t){return o.a.createElement(b,{key:t._id,card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})})))),o.a.createElement(E,{name:"delete",title:"Are you sure?",isOpen:!1,onClose:e.onCloseButtons},o.a.createElement("button",{className:"button button_action_submit",type:"submit",value:"Save","aria-label":"confirm-delete-card"},"Yes")),o.a.createElement(v,{onClose:e.onCloseButtons,card:e.selectedCard}))};var k=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Around The U.S."))},N=a(22),O=a(23),S=new(function(){function e(t){Object(N.a)(this,e),this.baseUrl=t.baseUrl,this.headers=t.headers}return Object(O.a)(e,[{key:"getCardList",value:function(e){return fetch(this.baseUrl+"/cards",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){if(e.ok)return e.json()}))}},{key:"getUserInfo",value:function(e){return fetch(this.baseUrl+"/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){if(e.ok)return e.json()}))}},{key:"setAvatar",value:function(e,t){return fetch(this.baseUrl+"/users/me/avatar",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({avatar:e})}).then((function(e){if(console.log(e),e.ok)return e.json()}))}},{key:"setUserInfo",value:function(e,t){var a=e.name,n=e.about;return fetch(this.baseUrl+"/users/me",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({name:a,about:n})}).then((function(e){if(e.ok)return e.json()}))}},{key:"addNewCard",value:function(e,t){var a=e.title,n=e.link;return fetch(this.baseUrl+"/cards",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({name:a,link:n})}).then((function(e){if(e.ok)return e.json()}))}},{key:"deleteCard",value:function(e,t){return fetch(this.baseUrl+"/cards/".concat(e),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}})}},{key:"updateLikes",value:function(e,t,a){var n=t?"DELETE":"PUT";return fetch(this.baseUrl+"/cards/likes/".concat(e),{method:n,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)}}).then((function(e){if(e.ok)return e.json()}))}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-2"}),y=a(11),j=a.n(y);var w=function(e){var t=o.a.useContext(_),a=o.a.useState(""),n=Object(s.a)(a,2),r=n[0],i=n[1],c=o.a.useState(""),l=Object(s.a)(c,2),u=l[0],m=l[1];return o.a.useEffect((function(){i(t&&t.name),m(t&&t.about)}),[t]),o.a.createElement(E,{name:"edit",title:"Edit profile",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:r,about:u})}},o.a.createElement("input",{className:"popup__input",type:"text",id:"name",name:"name",placeholder:"Name",minLength:"2",maxLength:"40",required:!0,value:r||"",onChange:function(e){i(e.target.value)},autoComplete:"on"}),o.a.createElement("span",{className:"popup__input-error",id:"name-input-error"}),o.a.createElement("input",{className:"popup__input",type:"text",id:"job",name:"job",placeholder:"About me",minLength:"2",maxLength:"200",required:!0,value:u||"",onChange:function(e){m(e.target.value)},autoComplete:"on"}),o.a.createElement("span",{className:"popup__input-error",id:"job-input-error"}),o.a.createElement("button",{className:"button button_action_submit button_inactive",type:"submit",value:"Save","aria-label":"submit-edit-profile"},"Save"))};var L=function(e){var t=o.a.useRef("");return o.a.createElement(E,{name:"avatar",title:"Change profile picture",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t})}},o.a.createElement("input",{className:"popup__input",type:"url",id:"avatar",name:"avatar",placeholder:"Enter link to image",minLength:"2",required:!0,ref:t,autoComplete:"on"}),o.a.createElement("span",{className:"popup__input-error",id:"avatar-input-error"}),o.a.createElement("button",{className:"button button_action_submit button_inactive",type:"submit",value:"Save","aria-label":"submit-change-avatar"},"Save"))};var A=function(e){var t=o.a.useState(""),a=Object(s.a)(t,2),n=a[0],r=a[1],i=o.a.useState(""),c=Object(s.a)(i,2),l=c[0],u=c[1];return o.a.createElement(E,{name:"add",title:"New place",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddNewCard({title:n,link:l})}},o.a.createElement("input",{className:"popup__input",type:"text",id:"title",name:"title",placeholder:"Title",minLength:"1",maxLength:"30",required:!0,onChange:function(e){r(e.target.value)},autoComplete:"on"}),o.a.createElement("span",{className:"popup__input-error",id:"title-input-error"}),o.a.createElement("input",{className:"popup__input",type:"url",id:"link",name:"link",placeholder:"Image link",required:!0,onChange:function(e){u(e.target.value)},autoComplete:"on"}),o.a.createElement("span",{className:"popup__input-error",id:"imageUrl-input-error"}),o.a.createElement("button",{className:"button button_action_submit button_inactive",type:"submit",value:"Create","aria-label":"submit-new-card-modal"},"Create"))};a(18);var U=function(e){var t=e.loggedIn,a=e.email,n=e.setEmail,r=e.password,i=e.setPassword,l=e.handleLoginSubmit,s=e.userEmail,m=e.setUserEmail,p=e.onClose,d=Object(u.g)();return o.a.useEffect((function(){t&&(d.push("/around"),m(a||s))})),o.a.createElement(o.a.Fragment,null,o.a.createElement(c.b,{className:"splash-page__call-out",to:"/signup"},"Sign up"),o.a.createElement(E,{name:"signin",title:"Log in",isOpen:!0,onClose:p,onSubmit:l},o.a.createElement("input",{className:"splash-page__input",type:"email",id:"email",name:"email",placeholder:"Email",minLength:"2",maxLength:"40",required:!0,value:a||"",onChange:function(e){return n(e.target.value)},autoComplete:"on"}),o.a.createElement("input",{className:"splash-page__input",type:"password",id:"password",name:"password",placeholder:"Password",minLength:"2",maxLength:"200",required:!0,value:r||"",onChange:function(e){return i(e.target.value)},autoComplete:"on"}),o.a.createElement("button",{className:"splash-page__submit",to:"/around"},"Log in"),o.a.createElement(c.b,{className:"splash-page__text",to:"/signup"},"Not a member yet? Sign up here!")))};var x=function(e){var t=e.registered,a=e.handleRegisterSubmit,r=e.email,i=e.setEmail,l=e.password,s=e.setPassword,m=e.onClose,p=Object(u.g)();return Object(n.useEffect)((function(){localStorage.getItem("token")&&p.push("/around")}),[p]),Object(n.useEffect)((function(){t&&p.push("/signin")}),[p,t]),o.a.createElement(o.a.Fragment,null,o.a.createElement(c.b,{className:"splash-page__call-out",to:"/signin"},"Log in"),o.a.createElement(E,{name:"signup",title:"Sign up",isOpen:!0,onClose:m,onSubmit:a},o.a.createElement("input",{className:"splash-page__input",type:"email",id:"email",name:"email",placeholder:"Email",required:!0,value:r||"",onChange:function(e){return i(e.target.value)},autoComplete:"on"}),o.a.createElement("input",{className:"splash-page__input",type:"password",id:"password",name:"password",placeholder:"Password",minLength:"2",maxLength:"200",required:!0,value:l||"",onChange:function(e){return s(e.target.value)},autoComplete:"on"}),o.a.createElement("button",{className:"splash-page__submit",to:"/around"},"Sign up"),o.a.createElement(c.b,{className:"splash-page__text",to:"/signin"},"Already a member? Log in here!")))},T=a(24),I=a.n(T),P=a(25),B=a.n(P);var D=function(e){return o.a.createElement(E,{name:"tooltip",isOpen:e.isOpen,onClose:e.onClose},o.a.createElement("img",{className:"popup__tooltip-icon",src:"success"===e.mode?I.a:B.a,alt:"check mark"}),o.a.createElement("h2",{className:"popup__tooltip-title"},"success"===e.mode?"Success! You have now been registered":"Oops, something went wrong! Please try again."))};var z=function(){var e=o.a.useState(!1),t=Object(s.a)(e,2),a=t[0],n=t[1],r=o.a.useState(!1),i=Object(s.a)(r,2),m=i[0],p=i[1],d=o.a.useState(!1),f=Object(s.a)(d,2),b=f[0],E=f[1],v=o.a.useState(!1),N=Object(s.a)(v,2),O=N[0],y=N[1],T=o.a.useState([]),I=Object(s.a)(T,2),P=I[0],B=I[1],z=o.a.useState(null),q=Object(s.a)(z,2),J=q[0],F=q[1],W=o.a.useState(null),R=Object(s.a)(W,2),H=R[0],Y=R[1],G=o.a.useState(!1),M=Object(s.a)(G,2),V=M[0],X=M[1],$=o.a.useState(!1),K=Object(s.a)($,2),Q=K[0],Z=K[1],ee=o.a.useState(""),te=Object(s.a)(ee,2),ae=te[0],ne=te[1],oe=o.a.useState(!1),re=Object(s.a)(oe,2),ie=re[0],ce=re[1],le=o.a.useState(""),se=Object(s.a)(le,2),ue=se[0],me=se[1],pe=o.a.useState(!1),de=Object(s.a)(pe,2),he=de[0],fe=de[1],ge=o.a.useState(localStorage.getItem("token")),_e=Object(s.a)(ge,2),be=_e[0],Ee=_e[1],ve=function(){ne(""),me("")},Ce=Object(u.g)();function ke(){X(!0)}function Ne(e){ce(e),y(!0)}function Oe(){E(!1),n(!1),p(!1),y(!1),F(null)}return o.a.useEffect((function(){be?j.a.getContent(be).then((function(e){X(!0),Z(e.data.email)})).catch((function(e){console.log(e)})):X(!1)}),[]),o.a.useEffect((function(){S.getUserInfo(be).then((function(e){Y(e.data),S.getCardList(be).then((function(e){e.data&&B((function(t){return e.data}))})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}),[be]),o.a.createElement(_.Provider,{value:H},o.a.createElement(c.a,null,o.a.createElement(h,{userEmail:Q,loggedIn:V,handleSignOut:function(){localStorage.removeItem("token"),X(!1),Ce.push("/signin")}}),o.a.createElement(u.d,null,o.a.createElement(u.b,{exact:!0,path:"/signin"},o.a.createElement(U,{loggedIn:V,email:ae,setEmail:ne,password:ue,setPassword:me,userEmail:Z,setUserEmail:Z,handleLogin:ke,handleLoginSubmit:function(e){e.preventDefault();var t=[e.target.email.value,e.target.password.value],a=t[0],n=t[1];j.a.authorize(a,n).then((function(e){if(e&&e.token)Ee(e.token),localStorage.setItem("token",e.token),ke();else{if(ve(),!a||!n)throw new Error("400 - one or more of the fields were not provided");if(!e)throw new Error("401 - bad email or password")}})).then((function(){ve()})).then((function(){Ce.push("/around")})).catch((function(e){return console.log(e.message)}))},handleToolTip:Ne}),o.a.createElement(D,{isOpen:O,onClose:Oe,loggedIn:V,mode:ie})),o.a.createElement(u.b,{exact:!0,path:"/signup"},o.a.createElement(x,{registered:he,email:ae,setEmail:ne,password:ue,setPassword:me,handleRegisterSubmit:function(e){e.preventDefault(),j.a.register(ae,ue).then((function(e){if(!e.data)throw Ne("failure"),new Error("400 - ".concat(e.message?e.message:e.error))})).then((function(e){return fe(!0),Ce.push("/signin"),e})).then((function(e){return Ne("success"),e})).then(ve).catch((function(e){console.log(e)}))},setUserEmail:Z,handleLogin:ke,handleToolTip:Ne}),o.a.createElement(D,{isOpen:O,onClose:Oe,loggedIn:V,mode:ie})),o.a.createElement(u.b,{exact:!0,path:"/"},V?o.a.createElement(u.a,{to:"/around"}):o.a.createElement(u.a,{to:"/signin"})),o.a.createElement(u.b,{path:"/around"},o.a.createElement(L,{isOpen:a,onClose:Oe,onUpdateAvatar:function(e){var t=e.avatar;S.setAvatar(t.current.value,be).then((function(e){Y(e.data)})).catch((function(e){return console.log(e)})),Oe()}}),o.a.createElement(w,{isOpen:m,onClose:Oe,onUpdateUser:function(e){var t=e.name,a=e.about;S.setUserInfo({name:t,about:a},be).then((function(e){Y(e.data)})).catch((function(e){return console.log(e)})),Oe()}}),o.a.createElement(A,{isOpen:b,onClose:Oe,onAddNewCard:function(e){var t=e.title,a=e.link;S.addNewCard({title:t,link:a},be).then((function(e){B([].concat(Object(l.a)(P),[e]))})).catch((function(e){return console.log(e)})),Oe()}}),o.a.createElement(g,{path:"/around",loggedIn:V,component:C,onCloseButtons:Oe,onEditProfile:function(){p(!0)},onAddPlace:function(){E(!0)},onEditAvatar:function(){n(!0)},onCardClick:function(e){F(e)},onCardLike:function(e){var t=e.likes.includes(H._id);S.updateLikes(e._id,t,be).then((function(t){var a=P.map((function(a){return a._id===e._id?t:a}));B(a)})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){S.deleteCard(e._id,be).then((function(){B(P.filter((function(t){return t._id!==e._id})))})).catch((function(e){console.log(e)}))},isAddPlacePopupOpen:b,isEditAvatarPopupOpen:a,cards:P,selectedCard:J}),o.a.createElement(k,null)),o.a.createElement(u.a,{from:"*",to:"/"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(c.a,{basename:"around-react"},o.a.createElement(z,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);
//# sourceMappingURL=main.ebe8fb83.chunk.js.map