(this["webpackJsonparound-app"]=this["webpackJsonparound-app"]||[]).push([[0],{19:function(e,t,a){},22:function(e,t,a){e.exports=a.p+"static/media/header-logo.71ad3aff.svg"},25:function(e,t,a){e.exports=a.p+"static/media/checkmark.75df9ada.svg"},26:function(e,t,a){e.exports=a.p+"static/media/redX.db56ee32.svg"},28:function(e,t,a){e.exports=a(39)},33:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(20),c=a.n(r),i=a(4),l=(a(33),a(13)),s=a(1),u=a(2);var m=function(e){var t=e.loggedIn,a=e.userEmail,n=e.handleSignOut;return o.a.createElement(o.a.Fragment,null,t&&o.a.createElement("ul",{className:"header__links"},o.a.createElement("li",{className:"header__email"},a),o.a.createElement("li",null,o.a.createElement(i.b,{className:"header__link",onClick:n,to:"/signin"},"Log out"))))},p=a(22),d=a.n(p);var h=function(e){var t=e.userEmail,a=e.loggedIn,n=e.handleSignOut;return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"header__logo",src:d.a,alt:"Around the U.S. Logo"}),o.a.createElement(m,{loggedIn:a,userEmail:t,handleSignOut:n}))},f=a(27),g=function(e){var t=e.component,a=Object(f.a)(e,["component"]);return o.a.createElement(u.b,null,(function(){return a.loggedIn?o.a.createElement(t,a):o.a.createElement(u.a,{to:"/signin"})}))},_=o.a.createContext();var b=function(e){var t=o.a.useContext(_),a=t&&e.card.owner._id===t._id,n="place__delete-btn ".concat(!a&&"place__delete-btn_hidden"),r=t&&e.card.likes.some((function(e){return e._id===t._id})),c="place__like-btn ".concat(r&&"place__like-btn_clicked");return o.a.createElement("li",{key:e.card._id,className:"place"},o.a.createElement("div",{className:"place__image",style:{backgroundImage:"url(".concat(e.card.link,")")},onClick:function(){e.onCardClick(e.card)}}),o.a.createElement("button",{className:n,"aria-label":"delete-card",onClick:function(){e.onCardDelete(e.card)}}),o.a.createElement("div",{className:"place__footer"},o.a.createElement("h2",{className:"place__name"},e.card.name),o.a.createElement("div",{className:"place__like-container"},o.a.createElement("button",{className:c,"aria-label":"like-or-unlike-card",onClick:function(){e.onCardLike(e.card)}}),o.a.createElement("p",{className:"place__like-counter"},e.card.likes.length))))};var E=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"popup__overlay"+(e.isOpen&&!e.name.startsWith("sign")?" popup__overlay_visible":"")}),o.a.createElement("div",{className:"popup__container popup__container_type_".concat(e.name)+(e.isOpen?" popup__container_visible":"")+(e.name.startsWith("sign")?" splash-page":"")},o.a.createElement("button",{className:"button button_action_close"+(e.name.startsWith("sign")?" button_hidden":""),type:"reset","aria-label":"close-".concat(e.name,"-modal"),onClick:e.onClose}),o.a.createElement("h2",{className:e.name.startsWith("sign")?"splash-page__title":"popup__title"},e.title),o.a.createElement("form",{id:"".concat(e.name,"-form"),name:"".concat(e.name,"Form"),className:"popup__form",action:"#",noValidate:!0,onSubmit:e.onSubmit},e.children)))};var v=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"popup__overlay"+(e.card?" popup__overlay_visible":"")}),o.a.createElement("figure",{className:"popup__image-container popup__container_type_image"+(e.card?" popup__image-container_visible":"")},o.a.createElement("button",{className:"button button_action_close",type:"reset","aria-label":"close-image-popup",onClick:e.onClose}),o.a.createElement("img",{src:e.card?e.card.link:"",alt:e.card?e.card.title:"",className:"popup__image"}),o.a.createElement("figcaption",{className:"popup__image-caption"},e.card?e.card.title:"")))};var C=function(e){var t=o.a.useContext(_);return o.a.createElement("main",null,o.a.createElement("section",{className:"profile"},o.a.createElement("div",null,o.a.createElement("img",{src:t&&t.avatar,alt:"Avatar",className:"profile__image",onClick:e.onEditAvatar}),o.a.createElement("button",{className:"button button_action_change-avatar","aria-label":"open-change-avatar-modal"})),o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",{className:"profile__text"},o.a.createElement("h2",{className:"profile__name"},t&&t.name),o.a.createElement("p",{className:"profile__job"},t&&t.about)),o.a.createElement("button",{className:"button button_action_edit","aria-label":"open-edit-profile-modal",onClick:e.onEditProfile})),o.a.createElement("button",{className:"button button_action_add","aria-label":"open-new-card-modal",onClick:e.onAddPlace})),o.a.createElement("div",{className:"places"},o.a.createElement("ul",{className:"places__grid"},e.cards.map((function(t){return o.a.createElement(b,{key:t._id,card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})})))),o.a.createElement(E,{name:"delete",title:"Are you sure?",isOpen:!1,onClose:e.onCloseButtons},o.a.createElement("button",{className:"button button_action_submit",type:"submit",value:"Save","aria-label":"confirm-delete-card"},"Yes")),o.a.createElement(v,{onClose:e.onCloseButtons,card:e.selectedCard}))};var k=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Around The U.S."))},N=a(23),O=a(24),S=new(function(){function e(t){Object(N.a)(this,e),this.baseUrl=t.baseUrl,this.headers=t.headers}return Object(O.a)(e,[{key:"getCardList",value:function(){return fetch(this.baseUrl+"/cards",{headers:this.headers}).then((function(e){if(e.ok)return e.json()}))}},{key:"getUserInfo",value:function(){return fetch(this.baseUrl+"/users/me",{headers:this.headers}).then((function(e){if(e.ok)return e.json()}))}},{key:"setAvatar",value:function(e){return fetch(this.baseUrl+"/users/me/avatar",{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then((function(e){if(e.ok)return e.json()}))}},{key:"setUserInfo",value:function(e){var t=e.name,a=e.about;return fetch(this.baseUrl+"/users/me",{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:a})}).then((function(e){if(e.ok)return e.json()}))}},{key:"addNewCard",value:function(e){var t=e.title,a=e.link;return fetch(this.baseUrl+"/cards",{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:a})}).then((function(e){if(e.ok)return e.json()}))}},{key:"deleteCard",value:function(e){return fetch(this.baseUrl+"/cards/".concat(e),{method:"DELETE",headers:this.headers})}},{key:"updateLikes",value:function(e,t){var a=t?"DELETE":"PUT";return fetch(this.baseUrl+"/cards/likes/".concat(e),{method:a,headers:this.headers}).then((function(e){if(e.ok)return e.json()}))}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-2",headers:{authorization:"dc340326-95ec-4474-9060-e6102316f742","Content-Type":"application/json"}}),j=a(9),y=a.n(j);var w=function(e){var t=o.a.useContext(_),a=o.a.useState(""),n=Object(s.a)(a,2),r=n[0],c=n[1],i=o.a.useState(""),l=Object(s.a)(i,2),u=l[0],m=l[1];return o.a.useEffect((function(){c(t&&t.name),m(t&&t.about)}),[t]),o.a.createElement(E,{name:"edit",title:"Edit profile",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:r,about:u})}},o.a.createElement("input",{className:"popup__input",type:"text",id:"name",name:"name",placeholder:"Name",minLength:"2",maxLength:"40",required:!0,value:r||"",onChange:function(e){c(e.target.value)},autoComplete:"on"}),o.a.createElement("span",{className:"popup__input-error",id:"name-input-error"}),o.a.createElement("input",{className:"popup__input",type:"text",id:"job",name:"job",placeholder:"About me",minLength:"2",maxLength:"200",required:!0,value:u||"",onChange:function(e){m(e.target.value)},autoComplete:"on"}),o.a.createElement("span",{className:"popup__input-error",id:"job-input-error"}),o.a.createElement("button",{className:"button button_action_submit button_inactive",type:"submit",value:"Save","aria-label":"submit-edit-profile"},"Save"))};var L=function(e){var t=o.a.useRef("");return o.a.createElement(E,{name:"avatar",title:"Change profile picture",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t})}},o.a.createElement("input",{className:"popup__input",type:"url",id:"avatar",name:"avatar",placeholder:"Enter link to image",minLength:"2",required:!0,ref:t,autoComplete:"on"}),o.a.createElement("span",{className:"popup__input-error",id:"avatar-input-error"}),o.a.createElement("button",{className:"button button_action_submit button_inactive",type:"submit",value:"Save","aria-label":"submit-change-avatar"},"Save"))};var U=function(e){var t=o.a.useState(""),a=Object(s.a)(t,2),n=a[0],r=a[1],c=o.a.useState(""),i=Object(s.a)(c,2),l=i[0],u=i[1];return o.a.createElement(E,{name:"add",title:"New place",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddNewCard({title:n,link:l})}},o.a.createElement("input",{className:"popup__input",type:"text",id:"title",name:"title",placeholder:"Title",minLength:"1",maxLength:"30",required:!0,onChange:function(e){r(e.target.value)},autoComplete:"on"}),o.a.createElement("span",{className:"popup__input-error",id:"title-input-error"}),o.a.createElement("input",{className:"popup__input",type:"url",id:"link",name:"link",placeholder:"Image link",required:!0,onChange:function(e){u(e.target.value)},autoComplete:"on"}),o.a.createElement("span",{className:"popup__input-error",id:"imageUrl-input-error"}),o.a.createElement("button",{className:"button button_action_submit button_inactive",type:"submit",value:"Create","aria-label":"submit-new-card-modal"},"Create"))};a(19);var x=function(e){var t=e.loggedIn,a=e.handleLogin,r=e.userEmail,c=e.setUserEmail,l=e.onClose,m=Object(u.g)(),p=Object(n.useState)(""),d=Object(s.a)(p,2),h=d[0],f=d[1],g=Object(n.useState)(""),_=Object(s.a)(g,2),b=_[0],v=_[1],C=function(e){e.preventDefault(),y.a.authorize(h,b).then((function(e){if(!h||!b)throw new Error("400 - one or more of the fields were not provided");if(!e)throw new Error("401 - the user with the specified email not found");e.token&&a()})).then((function(){f(""),v("")})).then((function(){m.push("/around")})).catch((function(e){return console.log(e.message)}))};return o.a.useEffect((function(){t&&(m.push("/around"),c(h||r))})),o.a.createElement(o.a.Fragment,null,o.a.createElement(i.b,{className:"splash-page__call-out",to:"/signup"},"Sign up"),o.a.createElement(E,{name:"signin",title:"Log in",isOpen:!0,onClose:l,onSubmit:C},o.a.createElement("input",{className:"splash-page__input",type:"email",id:"email",name:"email",placeholder:"Email",minLength:"2",maxLength:"40",required:!0,value:h||"",onChange:function(e){return f(e.target.value)},autoComplete:"on"}),o.a.createElement("input",{className:"splash-page__input",type:"password",id:"password",name:"password",placeholder:"Password",minLength:"2",maxLength:"200",required:!0,value:b||"",onChange:function(e){return v(e.target.value)},autoComplete:"on"}),o.a.createElement("button",{className:"splash-page__submit",onClick:C,to:"/around"},"Log in"),o.a.createElement(i.b,{className:"splash-page__text",to:"/signup"},"Not a member yet? Sign up here!")))};var A=function(e){var t=e.handleToolTip,a=(e.handleLogin,e.onClose),r=Object(n.useState)(""),c=Object(s.a)(r,2),l=c[0],m=c[1],p=Object(n.useState)(""),d=Object(s.a)(p,2),h=d[0],f=d[1],g=Object(u.g)(),_=function(){m(""),f("")},b=function(e){e.preventDefault(),y.a.register(l,h).then((function(e){if(!e.data)throw t("failure"),new Error("400 - ".concat(e.message?e.message:e.error))})).then((function(e){return g.push("/signin"),e})).then((function(e){return t("success"),e})).then(_).catch((function(e){console.log(e)}))};return Object(n.useEffect)((function(){localStorage.getItem("token")&&g.push("/around")}),[g]),o.a.createElement(o.a.Fragment,null,o.a.createElement(i.b,{className:"splash-page__call-out",to:"/signin"},"Log in"),o.a.createElement(E,{name:"signup",title:"Sign up",isOpen:!0,onClose:a,onSubmit:b},o.a.createElement("input",{className:"splash-page__input",type:"email",id:"email",name:"email",placeholder:"Email",required:!0,value:l||"",onChange:function(e){return m(e.target.value)},autoComplete:"on"}),o.a.createElement("input",{className:"splash-page__input",type:"password",id:"password",name:"password",placeholder:"Password",minLength:"2",maxLength:"200",required:!0,value:h||"",onChange:function(e){return f(e.target.value)},autoComplete:"on"}),o.a.createElement("button",{className:"splash-page__submit",onClick:b,to:"/around"},"Sign up"),o.a.createElement(i.b,{className:"splash-page__text",to:"/signin"},"Already a member? Log in here!")))},I=a(25),T=a.n(I),P=a(26),D=a.n(P);var q=function(e){return o.a.createElement(E,{name:"tooltip",isOpen:e.isOpen,onClose:e.onClose},o.a.createElement("img",{className:"popup__tooltip-icon",src:"success"===e.mode?T.a:D.a,alt:"check mark"}),o.a.createElement("h2",{className:"popup__tooltip-title"},"success"===e.mode?"Success! You have now been registered":"Oops, something went wrong! Please try again."))};var J=function(){var e=o.a.useState(!1),t=Object(s.a)(e,2),a=t[0],n=t[1],r=o.a.useState(!1),c=Object(s.a)(r,2),m=c[0],p=c[1],d=o.a.useState(!1),f=Object(s.a)(d,2),b=f[0],E=f[1],v=o.a.useState(!1),N=Object(s.a)(v,2),O=N[0],j=N[1],I=o.a.useState([]),T=Object(s.a)(I,2),P=T[0],D=T[1],J=o.a.useState(null),B=Object(s.a)(J,2),F=B[0],W=B[1],z=o.a.useState(null),H=Object(s.a)(z,2),Y=H[0],G=H[1],M=o.a.useState(!1),R=Object(s.a)(M,2),V=R[0],X=R[1],$=o.a.useState(!1),K=Object(s.a)($,2),Q=K[0],Z=K[1],ee=o.a.useState(!1),te=Object(s.a)(ee,2),ae=te[0],ne=te[1],oe=Object(u.g)();function re(){X(!0)}function ce(e){ne(e),j(!0)}function ie(){E(!1),n(!1),p(!1),j(!1),W(null)}return o.a.useEffect((function(){var e=localStorage.getItem("token");e?y.a.getContent(e).then((function(e){X(!0),Z(e.data.email)})).catch((function(e){console.log(e)})):X(!1)}),[]),o.a.useEffect((function(){S.getUserInfo().then((function(e){G(e),S.getCardList().then((function(e){e&&D((function(t){return[].concat(Object(l.a)(t),Object(l.a)(e))}))})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}),[]),o.a.createElement(_.Provider,{value:Y},o.a.createElement(i.a,null,o.a.createElement(h,{userEmail:Q,loggedIn:V,handleSignOut:function(){localStorage.removeItem("token"),X(!1),oe.push("/signin")}}),o.a.createElement(u.d,null,o.a.createElement(u.b,{exact:!0,path:"/signin"},o.a.createElement(x,{loggedIn:V,userEmail:Z,setUserEmail:Z,handleLogin:re,handleToolTip:ce}),o.a.createElement(q,{isOpen:O,onClose:ie,loggedIn:V,mode:ae})),o.a.createElement(u.b,{exact:!0,path:"/signup"},o.a.createElement(A,{setUserEmail:Z,handleLogin:re,handleToolTip:ce}),o.a.createElement(q,{isOpen:O,onClose:ie,loggedIn:V,mode:ae})),o.a.createElement(u.b,{exact:!0,path:"/"},V?o.a.createElement(u.a,{to:"/around"}):o.a.createElement(u.a,{to:"/signin"})),o.a.createElement(u.b,{path:"/around"},o.a.createElement(L,{isOpen:a,onClose:ie,onUpdateAvatar:function(e){var t=e.avatar;S.setAvatar(t.current.value).then((function(e){G(e)})).catch((function(e){return console.log(e)})),ie()}}),o.a.createElement(w,{isOpen:m,onClose:ie,onUpdateUser:function(e){var t=e.name,a=e.about;S.setUserInfo({name:t,about:a}).then((function(e){G(e)})).catch((function(e){return console.log(e)})),ie()}}),o.a.createElement(U,{isOpen:b,onClose:ie,onAddNewCard:function(e){var t=e.title,a=e.link;S.addNewCard({title:t,link:a}).then((function(e){D([].concat(Object(l.a)(P),[e]))})).catch((function(e){return console.log(e)})),ie()}}),o.a.createElement(g,{path:"/around",loggedIn:V,component:C,onCloseButtons:ie,onEditProfile:function(){p(!0)},onAddPlace:function(){E(!0)},onEditAvatar:function(){n(!0)},onCardClick:function(e){W(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===Y._id}));S.updateLikes(e._id,t).then((function(t){var a=P.map((function(a){return a._id===e._id?t:a}));D(a)})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){S.deleteCard(e._id).then((function(){D(P.filter((function(t){return t._id!==e._id})))})).catch((function(e){console.log(e)}))},isAddPlacePopupOpen:b,isEditAvatarPopupOpen:a,cards:P,selectedCard:F}),o.a.createElement(k,null)),o.a.createElement(u.a,{from:"*",to:"/"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(i.a,null,o.a.createElement(J,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t){var a="https://register.nomoreparties.co";e.exports.register=function(e,t){return fetch("".concat(a,"/signup"),{method:"POST",headers:{Acccept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()}))},e.exports.authorize=function(e,t){return fetch("".concat(a,"/signin"),{method:"POST",headers:{Acccept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){if(!e.message)return localStorage.setItem("token",e.token),e}))},e.exports.getContent=function(e){return fetch("".concat(a,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.ok?e.json():Promise.reject("".concat(e.status," - ").concat(e.message))}))}}},[[28,1,2]]]);
//# sourceMappingURL=main.64d01ff4.chunk.js.map